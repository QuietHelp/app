module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},82524,a=>{"use strict";var b=a.i(6001),c=a.i(65936);let d=null;function e(){return d||(d=new b.Client({webSocketFactory:()=>new c.default("http://localhost:8080/ws"),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:()=>console.log("WebSocket connected"),onDisconnect:()=>console.log("WebSocket disconnected"),onStompError:a=>{console.error("STOMP error:",a.headers.message,a.body)}})).activate(),d}function f(a){return new Promise(b=>{if(a.connected)return b();let c=a.onConnect;a.onConnect=d=>{c&&c(d),b(),a.onConnect=c??(()=>{})}})}a.s(["getStompClient",()=>e,"waitForConnection",()=>f])},9387,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(82524);function f({sessionId:a,mood:d,age:f,country:g,onMatchFound:h}){let i=(0,c.useRef)(null),j=(0,c.useRef)(!1),k=(0,c.useRef)(h);return(0,c.useEffect)(()=>{k.current=h},[h]),(0,c.useEffect)(()=>{let b=!0;return(async()=>{try{let c=(0,e.getStompClient)();if(await (0,e.waitForConnection)(c),!b||j.current)return;j.current=!0,i.current=c.subscribe(`/topic/match/${a}`,a=>{try{let b=JSON.parse(a.body);k.current(b)}catch(a){console.error("Failed to parse match message:",a)}}),c.publish({destination:"/app/match.join",body:JSON.stringify({sessionId:a,mood:d,age:f,country:g})})}catch(a){console.error("Failed to setup WebSocket:",a)}})(),()=>{b=!1,j.current=!1,i.current&&(i.current.unsubscribe(),i.current=null)}},[a,d,f,g]),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"h1 text-white mb-4 sm:mb-6",children:"Looking for someone..."}),(0,b.jsx)("p",{className:"text-lg sm:text-xl text-white/90",children:"We're finding someone who understands."}),(0,b.jsx)("div",{className:"mt-8 flex justify-center",children:(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-white/30 border-t-white"})}),(0,b.jsx)("footer",{className:"mt-8 text-white/70 text-sm"})]})}function g(){let a=(0,d.useRouter)(),[e,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1);(0,c.useEffect)(()=>{k(!0),g(sessionStorage.getItem("sessionId"));let a=sessionStorage.getItem("matchingData");if(a)try{i(JSON.parse(a))}catch{i(null)}else i(null)},[]),(0,c.useEffect)(()=>{if(j){if(!e)return void a.push("/");if(!h)return void a.push("/mood")}},[e,h,a,j]);let l=(0,c.useCallback)(b=>{sessionStorage.setItem("matchData",JSON.stringify(b)),a.push(`/chat/${b.roomId}`)},[a]);return j&&e&&h?(0,b.jsx)("div",{className:"h-full overflow-auto",children:(0,b.jsx)("div",{className:"min-h-screen flex flex-col p-4 sm:p-6 lg:p-8 gradient-bg",children:(0,b.jsx)("main",{className:"grow flex items-center justify-center",children:(0,b.jsx)(f,{sessionId:e,mood:h.mood,age:h.age,country:h.country,onMatchFound:l})})})}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-bg",children:(0,b.jsx)("div",{className:"text-white text-lg",children:"Loading..."})})}function h(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading..."}),children:(0,b.jsx)(g,{})})}a.s(["default",()=>h],9387)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6bc85ab2._.js.map